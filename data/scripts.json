[
  {
    "type": "jquery",
    "title": "answerWidth",
    "code": "<style label=\"answerWidth\" cond=\"not gv.request.device.isMobileDevice()\" arg:tw=\"850px\" name=\"question.after\"><![CDATA[\n<style>\n    .grid.grid-table-mode.setWidth {\n max-width: $(tw) !important;\n    }\n\n</style>\n]]></style>",
    "tags": [
      "style"
    ]
  },
  {
    "type": "jquery",
    "title": "subQuestionHeader1",
    "code": "<style label=\"subQuestionHeader1\" arg:headerText=\"testing\" name=\"question.left-blank-legend\"><![CDATA[\n<$(tag) rowspan=\"2\" class=\"cell nonempty legend sub-question-header\">\n  <center><strong>$(headerText)</strong></center>\n</$(tag)>\n<script>\ndocument.querySelectorAll('.sub-question-header')[1].style.display = 'none';\n</script>\n]]></style>",
    "tags": [
      "style"
    ]
  },
  {
    "type": "jquery",
    "title": "hideElements1",
    "code": "<style label=\"hideElements1\" name=\"question.element\"><![CDATA[\n\\@if ec.simpleList\n<div class=\"element $(rowStyle) $(levels) $(extraClasses) ${col.group.styles.ss.groupClassNames if col.group else (row.group.styles.ss.groupClassNames if row.group else \"\")} $(col.styles.ss.colClassNames) $(row.styles.ss.rowClassNames) ${\"clickableCell\" if isClickable else \"\"}\"$(extra)>\n   ${v2_insertStyle('el.label.start')}\n   ${v2_insertStyle('el.label.end')}\n</div>\n\\@else\n<$(tag) $(headers) class=\"cell nonempty element $(levels) ${\"desktop\" if this.grouping.cols else \"mobile\"} border-collapse $(extraClasses) ${col.group.styles.ss.groupClassNames if col.group else (row.group.styles.ss.groupClassNames if row.group else \"\")} $(col.styles.ss.colClassNames) $(row.styles.ss.rowClassNames) ${\"clickableCell\" if isClickable else \"\"}\"$(extra)>\n   ${v2_insertStyle('el.label.start')}\n   ${v2_insertStyle('el.label.end')}\n</$(tag)>\n\\@endif\n]]></style>",
    "tags": [
      "style"
    ]
  },
  {
    "type": "jquery",
    "title": "tableWidth",
    "code": "<style label=\"tableWidth\" cond=\"1\" arg:tx=\"900px\" arg:tx2=\"35.5%\" name=\"question.after\"><![CDATA[\n<script>\nsetInterval(function(){\n$ ('.question').addClass('disableMobileAccordion'); \n$ ('.answers').removeClass('answers-list').addClass('answers-table');    \n$ ('.grid').removeClass('grid-list-mode').addClass('grid-table-mode');\n$ (\"th[scope*=col]\").css('width','fit-content').css('min-width','20px').css('max-width','120px');\n},0);\n</script>\n\n<style>\n.grid.grid-table-mode.setWidth {\n    width: $(tx) !important;\n}\n.grid.grid-table-mode .colCount-7 .col-legend {\n    width: $(tx2);\n}\n</style>\n]]></style>",
    "tags": [
      "style"
    ]
  },
  {
    "type": "jquery",
    "title": "readonly_row_col",
    "code": "<style label=\"readonly_row_col\" cond=\"1\" arg:qn=\"\" name=\"el.text\"><![CDATA[\n<input type=\"number\" name=\"$(name)\" id=\"$(id)\" value=\"$(value)\" size=\"$(size)\" readonly style=\"background-color: #ccc;color: red; font-weight: bold; width: 4em; text-align:center;\" class=\"input text-input\" aria-labelledby=\"$(qn)_${row.label}_left $(qn)_${col.label}\" $(extra)/>\n\\@if row.styles.ss.postText or this.styles.ss.postText\n<span class=\"post-text\">\n    &nbsp;${row.styles.ss.postText or this.styles.ss.postText or \"\"}\n</span>\n\\@endif\n]]></style>",
    "tags": [
      "style"
    ]
  },
  {
    "type": "jquery",
    "title": "mobilescreen1",
    "code": "<style label=\"mobilescreen1\" name=\"question.after\"><![CDATA[\n<div id=\"mobiinst\">\n  <div class=\"mobi-msg\">${res.pipe_mobilescreen}</div>\n  <img src=\"[rel phone.gif]\" alt=\"Rotate phone\" />\n  <br/>\n  <img src=\"[rel mobile_flip.png]\" alt=\"Flip phone\" />\n</div>\n\n<script>\n$ (document).ready(function(){\n  var isMobile = ${\"1\" if gv.request.device.isMobileDevice() else \"0\"};\n\n  function adjustViewport() {\n    var landscape = window.matchMedia(\"(orientation: landscape)\").matches;\n    var content = landscape\n      ? \"width=920, initial-scale=0.8, maximum-scale=1.0, user-scalable=no\"\n      : \"width=device-width, initial-scale=0.9, maximum-scale=1.0, user-scalable=no\";\n\n    // if <meta name=\"viewport\"> doesnâ€™t exist, create it\n    if ($ (\"meta[name=viewport]\").length === 0) {\n      $ (\"head\").append('<meta name=\"viewport\">');\n    }\n    $ (\"meta[name=viewport]\").attr(\"content\", content);\n  }\n\n  function checkOrientation(){\n    $ (\"#mobiinst\").toggle(!window.matchMedia(\"(orientation: landscape)\").matches && isMobile==1);\n    adjustViewport();\n  }\n\n  $ (window).on(\"orientationchange resize\", checkOrientation);\n  checkOrientation(); // run on load\n\n  // Fix answers/grid layout once\n  $ ('.answers').removeClass('answers-list').addClass('answers-table');    \n  $ ('.grid').removeClass('grid-list-mode').addClass('grid-table-mode');\n});\n</script>\n\n<style>\n#mobiinst {\n  display: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  padding: 100px 10px 0 10px;\n  z-index: 9999;\n  width: 100%;\n  height: 100vh;\n  color: red;\n  background-color: #E0E0E0;\n}\n#mobiinst img {\n  max-width: 350px;\n  display: block;\n  height: auto;\n}\n.mobi-msg {\n  width: 350px;\n}\n</style>\n]]></style>",
    "tags": [
      "JS"
    ]
  },
  {
    "type": "jquery",
    "title": "first_column_sum_hide_selected",
    "code": "<style label=\"first_column_sum_hide_selected\" cond=\"1\" arg:cols=\"0,2\" name=\"question.after\"><![CDATA[\n<script>\n$ (document).ready(function () {\n  const qns = \"$(cols)\".split(\",\").map(q => parseInt(q.trim()));\n\n  setTimeout(function () {\n    qns.forEach(function (i) {\n      $ (\"td.sq-autosum-col\").eq(i).html(\"\"); // Clear content of each target column\n    });\n  }, 0);\n});\n</script>\n]]></style>",
    "tags": [
      "style"
    ]
  },
  {
    "type": "jquery",
    "title": "autosum_With_None",
    "code": "<style label=\"autosum_With_None\" cond=\"0\" arg:cls=\"\" arg:qn=\"\" name=\"question.after\"><![CDATA[\n<script>\n$ (document).ready(function () {\n    // Detect the total number of columns by checking .colX class names\n    const columnCount = $ (\"[class*='col']\").filter(function () {\n        return this.className.match(/\\bcol\\d+\\b/);\n    }).map(function () {\n        const match = this.className.match(/\\bcol(\\d+)\\b/);\n        return match ? parseInt(match[1], 10) : null;\n    }).get().reduce((max, num) => Math.max(max, num), 0);\n\n    // Loop through columns and move checkbox input into corresponding .None cell\n    for (let i = 1; i <= columnCount; i++) {\n        $ (\".col\" + i + \".None1\").append($ (\".row\" + i + \" .input\").parent());\n    }\n\n    // Hide question\n    // $ ('#question_$(qn)').hide();\n    $ ('.$(cls)').hide();\n\n    // Checkbox change logic\n    $ (\".checkbox\").on(\"change\", function () {\n        for (let i = 1; i <= columnCount; i++) {\n            const $col = $ (\".col\" + i);\n            if ($col.find(\".checkbox:checked\").length > 0) {\n                $col.find(\".text-input\").val('').change();\n            } else {\n                $col.find(\".text-input\").css({\n                    // 'background-color': '',\n                    'pointer-events': ''\n                });\n            }\n        }\n    });\n\n    // Text input logic\n    for (let i = 1; i <= columnCount; i++) {\n        const $col = $ (\".col\" + i);\n        $col.find(\".text-input\").on(\"input\", function () {\n            $col.find(\".checkbox\").prop(\"checked\", false).trigger(\"change\");\n        });\n    }\n});\n</script>\n]]></style>\n\n  <number \n   label=\"Q110\"\n   autosumdq:operator=\"eq\"\n   autosumdq:sumToVal=\"S9.r1.c2.ival+S9.r2.c2.ival,S9.r1.c3.ival+S9.r2.c3.ival\"\n   grouping=\"cols\"\n   optional=\"0\"\n   size=\"4\"\n   uses=\"autosumdq.6\"\n   verify=\"range(0,999)\">\n    <title>Of the <b>${S9.r1.c2.ival + S9.r2.c2.ival} Phenylketonuria (PKU) patients</b> that are <b>&lt;12 years old</b> with <b>mild-moderate disease</b> and the <b>${S9.r1.c3.ival + S9.r2.c3.ival} patients</b> that are <b>&lt;12 years old</b> with <b>classic/severe disease</b> that you [pipe: hPipe_S8] in the past 12 months, how many received each of the <b>following treatments</b>?</title>\n    <comment>Please enter a whole number in each box.</comment>\n    <exec>\nautoSumEvalPrevResponses(this)\n    </exec>\n\n    <validate>\n# autoSumValidate(this)\nvalidate_open_rows(this, ['r98'])\n\nc1_sum = S9.r1.c2.ival + S9.r2.c2.ival\nc2_sum = S9.r1.c3.ival + S9.r2.c3.ival\nif (c1_sum gt 0) and not Q110x1.r1 and Q110.c1.sum != c1_sum:\n\terror(this.lget('point-mismatch', sum=c1_sum , points=Q110.c1.sum ), col=Q110.c1)\nif (c2_sum gt 0) and not Q110x1.r2 and Q110.c2.sum != c2_sum:\n\terror(this.lget('point-mismatch', sum=c2_sum , points=Q110.c2.sum ), col=Q110.c2)\n    </validate>\n\n    <col label=\"c1\" cond=\"(S9.r1.c2.ival + S9.r2.c2.ival) gt 0\" ss:colClassNames=\"col1\"><b>&lt;12 years old</b> with <b>mild</b><b>-moderate </b>disease <b>(Untreated Phe levels 601-1200 Î¼mol/L)</b></col>\n    <col label=\"c2\" cond=\"(S9.r1.c3.ival + S9.r2.c3.ival) gt 0\" ss:colClassNames=\"col2\"><b>&lt;12 years old</b> with<b> classic/severe </b>disease <b>(Untreated Phe levels &gt;1200 Î¼mol/L)</b></col>\n    <row label=\"r1\">Sepiapterin (SEPHIENCE) + diet restrictions / medical nutrition therapy (MNT)</row>\n    <row label=\"r2\">Pegvaliase (PALYNZIQ) +/- diet restrictions / medical nutrition therapy (MNT)</row>\n    <row label=\"r3\" cond=\"hCountry.US or hCountry.DE or hCountry.IT\">Generic Sapropterin [pipe: pipe_Q100_r3] + diet restrictions / medical nutrition therapy (MNT)</row>\n    <row label=\"r4\">Branded Sapropterin [pipe: pipe_Q100_r4] + diet restrictions / medical nutrition therapy (MNT)</row>\n    <row label=\"r5\" cond=\"hCountry.US\">Branded Sapropterin (Javygtor) + diet restrictions / medical nutrition therapy (MNT)</row>\n    <row label=\"r6\">Diet restrictions / medical nutrition therapy (MNT) only</row>\n    <row label=\"r98\" open=\"1\" openOptional=\"1\" openSize=\"25\" optional=\"1\" randomize=\"0\">Other (please specify:)</row>\n    <row label=\"r99\" optional=\"1\" randomize=\"0\" ss:rowClassNames=\"None1\" where=\"survey,report,notdp\">None of the above</row>\n    <style arg:headerText=\"${res.Hedder_Q110}\" copy=\"subQuestionHeader1\" name=\"question.left-blank-legend\"/>\n    <style cond=\"1\" arg:cls=\"Q110x1\" copy=\"autosum_With_None\" name=\"question.after\"/>\n    <style name=\"el.text\" rows=\"r99\"/>\n    <style cond=\"gv.request.device.isMobileDevice()\" copy=\"mobilescreen1\" name=\"question.after\"/>\n    <style cond=\"not gv.request.device.isMobileDevice()\" arg:tw=\"900px\" copy=\"answerWidth\" name=\"question.after\"/>\n  </number>\n\n  <checkbox \n   label=\"Q110x1\"\n   ss:questionClassNames=\"Q110x1\">\n    <title><span></span></title>\n    <row label=\"r1\" ss:rowClassNames=\"row1\"><b>&lt;12 years old</b> with <b>mild</b><b>-moderate </b>disease <b>(Untreated Phe levels 601-1200 Î¼mol/L)</b></row>\n    <row label=\"r2\" ss:rowClassNames=\"row2\"><b>&lt;12 years old</b> with<b> classic/severe </b>disease <b>(Untreated Phe levels &gt;1200 Î¼mol/L)</b></row>\n  </checkbox>",
    "tags": [
      "JS"
    ]
  },
  {
    "type": "jquery",
    "title": "Tooltip",
    "code": "<style label=\"Tooltip\" name=\"question.after\"><![CDATA[\n<style>\n.custom-tooltip {\n  position: absolute;\n  max-width: 40vw;\n  padding: 6px 10px;\n  border-radius: 6px;\n  font-size: 0.85em;\n  z-index: 10000;\n  background: #000;\n  color: #fff;\n  border: 1px solid #333;\n  box-shadow: 0 2px 6px rgba(0,0,0,0.3);\n  pointer-events: none;\n  opacity: 0;\n  transition: opacity 0.2s;\n  word-wrap: break-word;\n}\n\n.custom-tooltip::after {\n  content: '';\n  position: absolute;\n  left: 50%;\n  transform: translateX(-50%);\n  border: 6px solid transparent;\n}\n\n.custom-tooltip.bottom::after { bottom: 100%; border-bottom-color: #000; }\n.custom-tooltip.top::after { top: 100%; border-top-color: #000; }\n\n[data-tooltip] { color: #007ac0; cursor: pointer; }\n\n\\@media screen and (max-width: 768px) {\n  .custom-tooltip { max-width: 80%; }\n}\n</style>\n\n<script>\ndocument.addEventListener('DOMContentLoaded', function() {\n  const tooltip = document.createElement('div');\n  tooltip.className = 'custom-tooltip bottom';\n  document.body.appendChild(tooltip);\n\n  function showTooltip(e) {\n    const el = e.currentTarget;\n    const content = el.getAttribute('data-tooltip');\n    if (!content) return;\n\n    tooltip.innerHTML = content;\n    tooltip.style.opacity = '0';\n    tooltip.style.display = 'block';\n\n    const rect = el.getBoundingClientRect();\n    const ttW = tooltip.offsetWidth, ttH = tooltip.offsetHeight;\n    const scrollY = window.scrollY, scrollX = window.scrollX;\n\n    // Choose placement\n    const spaceBelow = window.innerHeight - rect.bottom;\n    const placement = (spaceBelow > ttH + 8) ? 'bottom' : 'top';\n    tooltip.className = 'custom-tooltip ' + placement;\n\n    const left = Math.max(4, Math.min(\n      rect.left + rect.width / 2 - ttW / 2 + scrollX,\n      window.innerWidth - ttW - 4\n    ));\n    const top = (placement === 'bottom')\n      ? rect.bottom + scrollY + 8\n      : rect.top + scrollY - ttH - 8;\n\n    tooltip.style.left = left + 'px';\n    tooltip.style.top = top + 'px';\n    tooltip.style.opacity = '1';\n  }\n\n  function hideTooltip() {\n    tooltip.style.opacity = '0';\n  }\n\n  document.querySelectorAll('[data-tooltip]').forEach(el => {\n    el.addEventListener('mouseenter', showTooltip);\n    el.addEventListener('mouseleave', hideTooltip);\n    el.addEventListener('touchstart', showTooltip);\n    el.addEventListener('touchend', hideTooltip);\n  });\n\n  window.addEventListener('scroll', hideTooltip);\n  window.addEventListener('resize', hideTooltip);\n});\n</script>\n]]></style>\n\n<res label=\"T1\"><span data-tooltip=\"${res.T22}\" data-tooltip-theme=\"tooltip-theme-yellow\">HR <b>BCG NaÃ¯ve</b> NMIBC</span></res>\n<res label=\"T22\">Patients with <b><u>papillary-only</u></b> high-risk non-muscle invasive bladder cancer (HR NMIBC) who have previously received a full course of BCG therapy and are either:<br /><br /><ul><li />BCG Experienced (i.e., recurrence after an initial complete response to BCG)<li />BCG Unresponsive (i.e., persistent or recurrent disease despite adequate BCG <b>* <u>AND</u> CIS within 12 months or HGTa or T1 within 6 months)</b></ul><i>* Adequate Induction (5 of 6 doses) + either 2 of 3 doses of Maintenance OR 2 of 6 doses of second induction</i></res>",
    "tags": [
      "Generic setups"
    ]
  },
  {
    "type": "python",
    "title": "OE validation - Numeric question",
    "code": "def validate_open_rows(this, row_list):\n for row_name in row_list:\n  eachRow = eval(\"this.%s\" % row_name)\n  has_values = any(\n   this.rows[eachRow.index][eachCol.index].val not in [0, \"\", None]\n   for eachCol in this.cols\n  )\n  if has_values and eachRow.open in [\"\", None]:\n   error(this.lget(\"extraInfo\"), eachRow)\n  elif not has_values and eachRow.open not in [\"\", None]:\n   error(this.lget(\"extraSelect\"), eachRow)",
    "tags": [
      "validation"
    ]
  },
  {
    "type": "jquery",
    "title": "Change Total text in autosumdq question.",
    "code": "<style label=\"m1\"\n       arg:txt=\"of all CSU patients I refer to another physician for management\"\n       name=\"question.after\"><![CDATA[\n<script>\n(function () {\n\n    var txt = '${txt}';\n    var timer = setInterval(function () {\n\n        var $el = $ ('td.sq-autosum-empty span.sumTotalVal');\n\n        if ($el.length) {\n            $el.html('<b>' + txt + '</b>');\n            clearInterval(timer); // stop once applied\n        }\n\n    }, 100); // check every 100ms\n\n})();\n</script>\n\n<style>\n.sq-autosum-empty {\n    text-align: center !important;\n}\n</style>\n]]></style>\n",
    "tags": [
      "style"
    ]
  },
  {
    "type": "jquery",
    "title": "Disable print screen,copy for protected-img",
    "code": "<style label=\"disablePasting\" mode=\"after\" name=\"respview.client.js\"><![CDATA[\n<script>\n$ (document).ready(function () {\n\n\n    if ($ (\".protected-img\").length > 0) {\n\n        $ (\"body\").addClass(\"has-protected-img\");\n\n        $ (document).on(\"keydown\", function (e) {\n            if ((e.ctrlKey || e.metaKey) && [\"c\",\"p\",\"s\"].includes(e.key.toLowerCase())) {\n                e.preventDefault();\n            }\n            if (e.key === \"PrintScreen\") {\n                e.preventDefault();\n            }\n        });\n\n        \n        $ (document).on(\"contextmenu\", function (e) {\n            e.preventDefault();\n        });\n    }\n\n});\n</script>\n\n<style>\n\n.protected-img {\n    pointer-events: none !important;\n    user-select: none !important;\n    -webkit-user-drag: none !important;\n}\n\n\n.has-protected-img @media print {\n  body {\n    display: none !important;\n  }\n}\n</style>\n]]></style>\n\n<res label=\"Test\"><img src=\"https://selfserve.decipherinc.com/survey/selfserve/21a7/250744/Product_X_1.png\" width=\"100%\" class=\"zoomable zoomable protected-img\" alt=\"\" /></res>",
    "tags": [
      "style"
    ]
  },
  {
    "type": "jquery",
    "title": "Image and HTML table popup and hyper links",
    "code": "<style label=\"popup_zoom_script_final\" cond=\"1\" mode=\"after\" name=\"respview.client.js\"><![CDATA[\n<script>\n$ (document).ready(function () {\n    // Append overlay/popup once\n    if ($ ('#customZoomOverlay').length === 0) {\n        $ ('body').append(\n            '<div id=\"customZoomOverlay\" style=\"display:none;\">' +\n            '<div id=\"customZoomPopup\">' +\n                '<div class=\"zoom-controls\">' +\n                    // Zoom icon from Fancybox\n                    '<button id=\"customZoomToggle\" class=\"zoom-control-button\" style=\"display:none;\" title=\"Zoom\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M18.7 17.3l-3-3a5.9 5.9 0 0 0-.6-7.6 5.9 5.9 0 0 0-8.4 0 5.9 5.9 0 0 0 0 8.4 5.9 5.9 0 0 0 7.7.7l3 3a1 1 0 0 0 1.3 0c.4-.5.4-1 0-1.5zM8.1 13.8a4 4 0 0 1 0-5.7 4 4 0 0 1 5.7 0 4 4 0 0 1 0 5.7 4 4 0 0 1-5.7 0z\"></path></svg></button>' +\n                    // Close icon from Fancybox\n                    '<button id=\"customZoomClose\" class=\"zoom-control-button\" title=\"Close\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M12 10.6L6.6 5.2 5.2 6.6l5.4 5.4-5.4 5.4 1.4 1.4 5.4-5.4 5.4 5.4 1.4-1.4-5.4-5.4 5.4-5.4-1.4-1.4-5.4 5.4z\"></path></svg></button>' +\n                '</div>' +\n                '<img id=\"customZoomImage\" src=\"\" style=\"display:none;\" />' +\n                '<video id=\"customZoomVideo\" src=\"\" controls autoplay controlsList=\"nodownload\" playsinline style=\"display:none;\"></video>' +\n            '</div>' +\n            '</div>'\n        );\n    }\n\n    // State variables\n    var scale = 1, originX = 0, originY = 0;\n    var isDragging = false, startX = 0, startY = 0, imgX = 0, imgY = 0;\n    var touchStartDist = 0, lastScale = 1;\n    var lastTapTime = 0;\n    var isMobile = $ (window).width() < 768;\n    var wasDragged = false; // New flag to prevent click event on drag\n\n    // Customizable zoom levels\n    const desktopMinZoom = 0.8;\n    const desktopMaxZoom = 1.0;\n    const mobileMinZoom = 1;\n    const mobileMaxZoom = 1.3;\n\n    function updateTransform() {\n        $ ('#customZoomImage').css('transform', 'translate(' + originX + 'px,' + originY + 'px) scale(' + scale + ')');\n    }\n\n    function closePopup() {\n        $ ('#customZoomOverlay').fadeOut(200);\n        // Reset transform and remove mobile zoom class on close\n        scale = 1;\n        originX = 0;\n        originY = 0;\n        updateTransform();\n        $ ('#customZoomImage').removeClass('zoomed-in-mobile');\n        // Pause video on close\n        $ ('#customZoomVideo')[0].pause();\n    }\n\n    // Open popup function\n    window.openZoomPopup = function (src) {\n        if (!src) return;\n        \n        // Hide all content initially\n        $ ('#customZoomImage, #customZoomVideo').hide();\n        $ ('#customZoomToggle').hide();\n\n        // Check if it's a video file\n        var videoExtensions = ['.mp4', '.mov', '.webm', '.ogg'];\n        var isVideo = videoExtensions.some(ext => src.toLowerCase().endsWith(ext));\n\n        if (isVideo) {\n            var $video = $ ('#customZoomVideo');\n            $video.attr('src', src).show();\n            // Play the video\n            $video[0].play();\n        } else {\n            var $img = $ ('#customZoomImage');\n            $img.attr('src', src).show();\n            $ ('#customZoomToggle').show(); // Show zoom button for images\n            \n            // Reset state variables for image\n            originX = 0; originY = 0;\n            isDragging = false;\n            touchStartDist = 0;\n            lastScale = 1;\n            lastTapTime = 0;\n            wasDragged = false; // Reset drag flag\n\n            // Determine initial image size based on screen width\n            if (isMobile) {\n                $img.css('max-width', '100%');\n                scale = mobileMinZoom;\n            } else {\n                $img.css('max-width', '100%');\n                scale = desktopMinZoom;\n            }\n            \n            updateTransform();\n            $img.off('load.openZoom').on('load.openZoom', function () {\n                updateTransform();\n            });\n        }\n        $ ('#customZoomOverlay').fadeIn(200);\n    };\n\n    // Delegate click on images to open popup\n    $ ('body').on('click', '.zoomable', function (e) {\n        e.preventDefault();\n        var src = $ (this).attr('src') || $ (this).attr('href');\n        window.openZoomPopup(src);\n    });\n\n    // Close handlers\n    $ ('#customZoomClose').on('click', closePopup);\n\t$ ('#customZoomOverlay').on('click', function(e) {\n\t    if (!$ (e.target).is('#customZoomImage, #customZoomVideo, .zoom-control-button, svg, path')) {\n\t        closePopup();\n\t    }\n\t});\n    // Zoom toggle button handler\n    $ ('#customZoomToggle').on('click', function() {\n        if (isMobile) {\n            if (scale === mobileMinZoom) {\n                scale = mobileMaxZoom;\n            } else {\n                scale = mobileMinZoom;\n            }\n        } else {\n            if (scale === desktopMinZoom) {\n                scale = desktopMaxZoom;\n            } else {\n                scale = desktopMinZoom;\n            }\n        }\n        originX = 0;\n        originY = 0;\n        updateTransform();\n    });\n\n    // Handle single and double taps for mobile\n    $ ('#customZoomImage').on('click', function (e) {\n        e.stopPropagation();\n\n        // If a drag just happened, don't execute the click logic\n        if (wasDragged) {\n            wasDragged = false; // Reset the flag\n            return;\n        }\n\n        var currentTime = new Date().getTime();\n        var tapLength = currentTime - lastTapTime;\n\n        if (isMobile) {\n            // Mobile single click handler: toggles between mobileMinZoom and mobileMaxZoom\n            handleMobileClick();\n            \n        } else {\n            handleDesktopClick();\n        }\n    });\n\n    // Mobile click handler: toggles scale between mobileMinZoom and mobileMaxZoom\n    function handleMobileClick() {\n        if (scale === mobileMinZoom) {\n            scale = mobileMaxZoom;\n        } else {\n            scale = mobileMinZoom;\n        }\n        originX = 0;\n        originY = 0;\n        requestAnimationFrame(updateTransform);\n    }\n\n    // Desktop click handler: toggles scale between desktopMinZoom and desktopMaxZoom\n    function handleDesktopClick() {\n        if (scale === desktopMinZoom) {\n            scale = desktopMaxZoom;\n        } else {\n            scale = desktopMinZoom;\n        }\n        originX = 0;\n        originY = 0;\n        requestAnimationFrame(updateTransform);\n    }\n\n    // MOUSE DRAG (desktop)\n    $ ('#customZoomImage').on('mousedown', function (e) {\n        if (e.which !== 1 || isMobile) return;\n        \n        var isZoomed = scale > 1 || $ ('#customZoomImage').hasClass('zoomed-in-mobile');\n        if (!isZoomed) return;\n        \n        isDragging = true;\n        startX = e.clientX;\n        startY = e.clientY;\n        imgX = originX;\n        imgY = originY;\n        $ (this).addClass('grabbing');\n        // Reset the drag flag when a new mousedown occurs\n        wasDragged = false;\n        e.preventDefault();\n    });\n\n    // MOUSEMOVE (shared)\n    $ (document).on('mousemove', function (e) {\n        if (!isDragging) return;\n        var dx = e.clientX - startX;\n        var dy = e.clientY - startY;\n        originX = imgX + dx;\n        originY = imgY + dy;\n        // If there's any movement, it's a drag\n        if (Math.abs(dx) > 5 || Math.abs(dy) > 5) {\n            wasDragged = true;\n        }\n        updateTransform();\n    });\n\n    // MOUSEUP (shared)\n    $ (document).on('mouseup', function () {\n        if (isDragging) {\n            isDragging = false;\n            $ ('#customZoomImage').removeClass('grabbing');\n        }\n    });\n\n    // Prevent native drag\n    $ (document).on('dragstart', '#customZoomImage', function (e) { e.preventDefault(); });\n\n    // TOUCH: pinch zoom + single-finger pan\n    $ ('#customZoomImage').on('touchstart', function (e) {\n        var touches = e.originalEvent.touches;\n        if (!touches) return;\n        e.preventDefault();\n        \n        var isZoomed = scale > 1 || $ ('#customZoomImage').hasClass('zoomed-in-mobile');\n\n        if (touches.length === 2) {\n            var dx = touches[0].pageX - touches[1].pageX;\n            var dy = touches[0].pageY - touches[1].pageY;\n            touchStartDist = Math.sqrt(dx * dx + dy * dy);\n            lastScale = scale;\n        } else if (touches.length === 1 && isZoomed) {\n            isDragging = true;\n            startX = touches[0].clientX;\n            startY = touches[0].clientY;\n            imgX = originX;\n            imgY = originY;\n            $ (this).addClass('grabbing');\n        }\n    });\n\n    $ ('#customZoomImage').on('touchmove', function (e) {\n        var touches = e.originalEvent.touches;\n        if (!touches) return;\n        e.preventDefault();\n        \n        if (touches.length === 2) {\n            var dx = touches[0].pageX - touches[1].pageX;\n            var dy = touches[0].pageY - touches[1].pageY;\n            var newDist = Math.sqrt(dx * dx + dy * dy);\n            if (touchStartDist) {\n                var pinchScale = newDist / touchStartDist;\n                var newScale = lastScale * pinchScale;\n                scale = Math.max(1, Math.min(5, newScale));\n                updateTransform();\n            }\n        } else if (touches.length === 1 && isDragging) {\n            var dx = touches[0].clientX - startX;\n            var dy = touches[0].clientY - startY;\n            originX = imgX + dx;\n            originY = imgY + dy;\n            updateTransform();\n        }\n    });\n\n    $ ('#customZoomImage').on('touchend touchcancel', function (e) {\n        if (isDragging) {\n            isDragging = false;\n            $ (this).removeClass('grabbing');\n        }\n        var touches = e.originalEvent.touches || [];\n        if (!touches.length) {\n            lastScale = scale;\n        }\n    });\n\n    // Mouse wheel zoom (centered visually)\n    $ ('#customZoomPopup').on('wheel', function (e) {\n        if (!isMobile) {\n            e.preventDefault();\n            var delta = (e.originalEvent.deltaY > 0 ? -0.08 : 0.08);\n            scale = Math.max(1, Math.min(5, scale + delta));\n            updateTransform();\n        }\n    });\n});\n\n\n</script>\n\n<script src=\"https://cdn.tailwindcss.com\"></script>\n<style>\n/* Disable interaction with native seek bar */\nvideo::-webkit-media-controls-timeline {\n    pointer-events: none;\n}\nvideo::-webkit-media-controls-seek-back-button,\nvideo::-webkit-media-controls-seek-forward-button {\n    display: none;\n}\n\n/* Shared CSS for both mobile and desktop */\n#customZoomOverlay {\n    position: fixed;\n    top: 0; left: 0;\n    width: 100vw; height: 100vh;\n    background: rgba(0,0,0,0.85);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n}\n\n#customZoomPopup {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw !important;\n    height: 100vh !important;\n    max-width: none !important;\n    max-height: none !important;\n    padding: 0 !important;\n    border-radius: 0 !important;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n/* The image element. Sizing will be controlled by JS. */\n#customZoomImage {\n    max-width: 100%;\n    max-height: 100vh;\n    transform-origin: center center;\n    cursor: grab;\n    user-select: none;\n    -webkit-user-drag: none;\n    transition: transform 0.12s ease-out, max-width 0.12s ease-out;\n    display: block;\n    touch-action: none; /* Prevents native browser zoom/pan on touch */\n}\n\n/* The video element */\n#customZoomVideo {\n    max-width: 70%;\n    max-height: 100vh;\n}\n\n/* Class to toggle to 100% on mobile click */\n#customZoomImage.zoomed-in-mobile {\n    max-width: 100% !important;\n}\n\n/* grabbing cursor while dragging */\n#customZoomImage.grabbing {\n    cursor: grabbing;\n}\n\n/* Control buttons container */\n.zoom-controls {\n    position: absolute;\n    top: 8px;\n    right: 8px;\n    z-index: 10000;\n    display: flex;\n    gap: 8px;\n}\n\n/* close button */\n.zoom-control-button {\n    background: rgb(220 191 191 / 13%);\n    border: none;\n    cursor: pointer;\n    padding: 6px;\n    border-radius: 4px;\n    width: 38px;\n    height: 38px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: background 0.2s;\n}\n.zoom-control-button:hover {\n    background: rgb(220 191 191 / 13%);\n}\n.zoom-control-button svg {\n    fill: #55d119;\n    width: 100%;\n    height: 100%;\n}\n\n.indent-2 {\n    text-indent: 0.5rem;\n\tpadding-left: 0.50em;\n}\n\n\n    </style>\n]]></style>\n<style label=\"popup_zoom_script_final\" cond=\"1\" mode=\"after\" name=\"respview.client.js\"><![CDATA[\n<script>\n$ (document).ready(function () {\n\n    /* ================= DEVICE ================= */\n    var isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);\n\n    /* ================= CREATE POPUP ================= */\n    if (!$ ('#htmlZoomOverlay').length) {\n        $ ('body').append(\n            '<div id=\"htmlZoomOverlay\" style=\"display:none;\">' +\n              '<div id=\"htmlZoomPopup\">' +\n                '<div class=\"zoom-controls\">' +\n                    '<button id=\"htmlZoomToggle\" class=\"zoom-control-button\" title=\"Zoom\">â¤¢</button>' +\n                    '<button id=\"htmlZoomClose\" class=\"zoom-control-button\" title=\"Close\">Ã—</button>' +\n                '</div>' +\n                '<div id=\"htmlZoomOuter\">' +\n                    '<div id=\"htmlZoomInner\"></div>' +\n                '</div>' +\n              '</div>' +\n            '</div>'\n        );\n    }\n\n    /* ================= STATE ================= */\n    var scale = 1, ox = 0, oy = 0;\n    var dragging = false, wasDragged = false;\n    var sx = 0, sy = 0, ix = 0, iy = 0;\n    var touchStartDist = 0, lastScale = 1;\n\n    var popupSize = 'small';       // desktop\n    var mobilePopupSize = 'small'; // mobile\n\n    /* ================= HELPERS ================= */\n    function updateTransform() {\n        $ ('#htmlZoomInner').css(\n            'transform',\n            'translate(' + ox + 'px,' + oy + 'px) scale(' + scale + ')'\n        );\n    }\n\n    function resetTransform() {\n        scale = 1;\n        ox = 0;\n        oy = 0;\n        updateTransform();\n    }\n\n    function applyPopupSize() {\n\n        if (isMobile) {\n            if (mobilePopupSize === 'small') {\n                $ ('#htmlZoomPopup').css({\n                    width: '90vw',\n                    maxWidth: '90vw',\n                    maxHeight: '95vh'\n                });\n            } else {\n                $ ('#htmlZoomPopup').css({\n                    width: '100vw',\n                    maxWidth: '100vw',\n                    maxHeight: '100vh'\n                });\n            }\n            return;\n        }\n\n        $ ('#htmlZoomPopup')\n            .removeClass('small large')\n            .addClass(popupSize === 'large' ? 'large' : 'small');\n    }\n\n    function autoFit() {\n        $ ('#htmlZoomPopup').css('height', 'auto');\n\n        var table = $ ('#htmlZoomInner').find('table')[0];\n        if (!table) return;\n\n        var vw = $ ('#htmlZoomOuter').width();\n        if (table.offsetWidth > vw) {\n            scale = vw / table.offsetWidth;\n            updateTransform();\n        }\n    }\n\n    /* ================= OPEN ================= */\n    window.openHTMLZoomPopup = function (html) {\n\n        $ ('#htmlZoomInner').html(html);\n        resetTransform();\n\n        popupSize = 'small';\n        mobilePopupSize = 'small';\n\n        applyPopupSize();\n\n        $ ('#htmlZoomOverlay').fadeIn(200, function () {\n            setTimeout(autoFit, 60);\n        });\n    };\n\n    /* ================= TOGGLE SIZE (RESET ALWAYS) ================= */\n    function toggleSize() {\n\n        // ðŸ”‘ HARD RESET on every resize (DESKTOP + MOBILE)\n        resetTransform();\n\n        if (isMobile) {\n            if (mobilePopupSize === 'small') {\n                mobilePopupSize = 'large';\n                applyPopupSize();\n                setTimeout(autoFit, 60);\n            }\n            return;\n        }\n\n        popupSize = popupSize === 'small' ? 'large' : 'small';\n        applyPopupSize();\n        setTimeout(autoFit, 60);\n    }\n\n    $ ('#htmlZoomToggle').on('click', function (e) {\n        e.stopPropagation();\n        toggleSize();\n    });\n\n    $ ('#htmlZoomOuter').on('click', function (e) {\n        if (wasDragged) {\n            wasDragged = false;\n            return;\n        }\n        e.stopPropagation();\n        toggleSize();\n    });\n\n    /* ================= CLOSE ================= */\n    $ ('#htmlZoomClose').on('click', function (e) {\n        e.stopPropagation();\n        resetTransform();\n        $ ('#htmlZoomOverlay').fadeOut(200);\n    });\n\n    $ ('#htmlZoomOverlay').on('click', function (e) {\n        if ($ (e.target).closest('#htmlZoomPopup').length) return;\n        resetTransform();\n        $ ('#htmlZoomOverlay').fadeOut(200);\n    });\n\n    /* ================= MOUSE DRAG ================= */\n    $ ('#htmlZoomOuter').on('mousedown', function (e) {\n        if (e.which !== 1) return;\n\n        dragging = true;\n        wasDragged = false;\n        sx = e.clientX;\n        sy = e.clientY;\n        ix = ox;\n        iy = oy;\n\n        e.preventDefault();\n        e.stopPropagation();\n    });\n\n    $ (document).on('mousemove', function (e) {\n        if (!dragging) return;\n\n        ox = ix + (e.clientX - sx);\n        oy = iy + (e.clientY - sy);\n        updateTransform();\n\n        if (Math.abs(e.clientX - sx) > 4 || Math.abs(e.clientY - sy) > 4) {\n            wasDragged = true;\n        }\n    });\n\n    $ (document).on('mouseup', function () {\n        dragging = false;\n    });\n\n    /* ================= WHEEL ZOOM (DESKTOP) ================= */\n    $ ('#htmlZoomPopup').on('wheel', function (e) {\n        if (isMobile) return;\n\n        e.preventDefault();\n        var delta = e.originalEvent.deltaY > 0 ? -0.08 : 0.08;\n        scale = Math.max(1, Math.min(4, scale + delta));\n        updateTransform();\n    });\n\n    /* ================= TOUCH (MOBILE: PINCH + PAN + SCROLL) ================= */\n    $ ('#htmlZoomOuter').on('touchstart', function (e) {\n        var t = e.originalEvent.touches;\n        wasDragged = false;\n\n        if (t.length === 2) {\n            var dx = t[0].pageX - t[1].pageX;\n            var dy = t[0].pageY - t[1].pageY;\n            touchStartDist = Math.sqrt(dx * dx + dy * dy);\n            lastScale = scale;\n            dragging = false;\n            return;\n        }\n\n        if (t.length === 1 && scale > 1) {\n            dragging = true;\n            sx = t[0].clientX;\n            sy = t[0].clientY;\n            ix = ox;\n            iy = oy;\n            return;\n        }\n\n        dragging = false; // allow native scroll\n    });\n\n    $ ('#htmlZoomOuter').on('touchmove', function (e) {\n        var t = e.originalEvent.touches;\n\n        if (t.length === 2) {\n            e.preventDefault();\n            var dx = t[0].pageX - t[1].pageX;\n            var dy = t[0].pageY - t[1].pageY;\n            var dist = Math.sqrt(dx * dx + dy * dy);\n\n            if (touchStartDist > 0) {\n                scale = Math.max(1, Math.min(4, lastScale * (dist / touchStartDist)));\n                updateTransform();\n                wasDragged = true;\n            }\n            return;\n        }\n\n        if (t.length === 1 && dragging && scale > 1) {\n            e.preventDefault();\n            ox = ix + (t[0].clientX - sx);\n            oy = iy + (t[0].clientY - sy);\n            updateTransform();\n            wasDragged = true;\n        }\n    });\n\n    $ ('#htmlZoomOuter').on('touchend touchcancel', function () {\n        dragging = false;\n        lastScale = scale;\n        touchStartDist = 0;\n    });\n\n    /* ================= OPEN FROM HTML LINK ================= */\n    $ ('body').on('click', 'a.html-pop', function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        var targetId = $ (this).data('target');\n        var $html = $ ('#' + targetId);\n        if ($html.length) {\n            openHTMLZoomPopup($html.prop('outerHTML'));\n        }\n    });\n\n    /* ================= OPEN .Zoomhtml ================= */\n    $ ('body').on('click', '.Zoomhtml', function (e) {\n\n        if ($ ('#htmlZoomOverlay').is(':visible')) {\n            e.stopPropagation();\n            return;\n        }\n\n        if (wasDragged) {\n            wasDragged = false;\n            return;\n        }\n\n        e.preventDefault();\n        openHTMLZoomPopup($ (this).prop('outerHTML'));\n    });\n\n});\n</script>\n\n<style>\n#htmlZoomOverlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,.85);\n    z-index: 999999;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n#htmlZoomPopup {\n    background: #fff;\n    border-radius: 8px;\n    box-shadow: 0 0 30px rgba(0,0,0,.6);\n    transition: width .25s ease, height .25s ease;\n}\n\n#htmlZoomPopup.small { width: 80vw; max-height: 95vh; }\n#htmlZoomPopup.large { width: 95vw; max-height: 95vh; }\n\n#htmlZoomOuter {\n    width: 100%;\n    height: 100%;\n    overflow-y: auto;\n    -webkit-overflow-scrolling: touch;\n}\n\n#htmlZoomInner {\n    transform-origin: 0 0;\n    display: inline-block;\n    padding: 20px;\n    transition: transform .15s ease-out;\n}\n\n.zoom-controls {\n    position: absolute;\n    top: 8px;\n    right: 8px;\n    display: flex;\n    gap: 8px;\n    z-index: 10000;\n}\n\n.zoom-control-button {\n    background: rgb(220 191 191 / 13%);\n    border: none;\n    cursor: pointer;\n    padding: 0px;\n    font-weight: bold;\n    font-size: xxx-large;\n    border-radius: 4px;\n    width: 38px;\n    height: 38px;\n    color: green;\n    display: flex;\n    justify-content: flex-end;\n    transition: background 0.2s;\n    align-items: anchor-center;\n}\n\n\\@media (max-width:580px) {\n\ttable.Zoomhtml {\n\t    font-size: 0.4em;\n\t    text-wrap: auto;\n\t}\n}\n</style>\n]]></style>\n\n\n<img src=\"https://selfserve.decipherinc.com/survey/selfserve/21a7/250744/Product_X_1.png?cbst_=96n3z2\" width=\"100%\" class=\"zoomable\" alt=\"\" />\n  <a href=\"https://selfserve.decipherinc.com/survey/selfserve/21a7/250744/Product_X_1.png?cbst_=96n3z2\" class=\"zoomable\">Click to view image</a><br />\n  <a href=\"https://isurveys.s3.us-east-1.amazonaws.com/MDS296/8339810-hd_1920_1080_24fps.mp4\" class=\"zoomable cursor-pointer rounded-lg shadow-lg\">Click to play video</a> Hidden question for get price 4 to 5 base on leastfill.\n\nin html need to add -------------> class=\"Zoomhtml\"",
    "tags": [
      "JS"
    ]
  },
  {
    "type": "jquery",
    "title": "Customized drag and drop setup.",
    "code": "<radio \n  label=\"Q500\"\n  grouping=\"cols\"\n  optional=\"1\"\n  ss:listDisplay=\"1\"\n  ss:questionClassNames=\"disableMobileAccordion\">\n  <title>Now weâ€™d like to see how you would put these messages together to create a clear, helpful story about <b>Product X</b>.<br /><br />\nPlease choose the messages that would make <b>[pipe: pipe_Q500]</b> most interested in talking with your doctor about <b>Product X</b>. You can pick as many or as few messages as you want, but you need to choose at least one message from each row.<br /><br />\nYou can pick as many or as few as you want, but please choose <b>at least one from each section</b>.<br /><br />\nHereâ€™s what we would like you to do:<br /><br />\n<ol>\n<li />Pick <b>one message</b> that grabs your attention first.\n<li />Pick <b>2 or 3 messages</b> that you think are the most important.\n<li />Pick <b>one message</b> that you think is the best ending.\n</ol></title>\n  <comment>[res INS_G]</comment>\n  <validate>\nif not (Q500.r1.any or Q500.r2.any or Q500.r3.any or Q500.r4.any):\n    error(\"Please select at least one message from <b>Theme 1</b>.\")\n\nif not (Q500.r5.any or Q500.r6.any or Q500.r7.any or Q500.r8.any):\n    error(\"Please select at least one message from <b>Theme 2</b>.\")\n\nif not (Q500.r9.any or Q500.r10.any or Q500.r11.any or Q500.r12.any):\n    error(\"Please select at least one message from <b>Theme 3</b>.\")\n\nif not (Q500.r13.any or Q500.r14.any or Q500.r15.any or Q500.r16.any):\n    error(\"Please select at least one message from <b>Theme 4</b>.\")\n\nif not Q500.c1.any:\n    error(\"Please select one message in the <b>Start</b> section.\")\n\nA1 = Q500.c2.count + Q500.c3.count + Q500.c4.count\n\nif A1 lt 2:\n    error(\"Please select at least <b>two messages</b> in the <b>Important Points</b> section.\")\n\nif not Q500.c5.any:\n    error(\"Please select one message in the <b>Final Thought</b> section.\")\n  </validate>\n\n  <group label=\"g1\" builder:axis=\"row\">THEME 1</group>\n  <group label=\"g2\" builder:axis=\"row\">THEME 2</group>\n  <group label=\"g3\" builder:axis=\"row\">THEME 3</group>\n  <group label=\"g4\" builder:axis=\"row\">THEME 4</group>\n  <row label=\"r1\" groups=\"g1\" ss:rowClassNames=\"r1\"><b>MESSAGE 1</b> MESSAGE 1 MESSAGE 1 MESSAGE 1 MESSAGE 1MESSAGE 1 MESSAGE 1 MESSAGE 1 MESSAGE 1</row>\n  <row label=\"r2\" groups=\"g1\" ss:rowClassNames=\"r2\">MESSAGE 2 MESSAGE 2 MESSAGE 2 MESSAGE 2 MESSAGE 2MESSAGE 2 MESSAGE 2 MESSAGE 2 MESSAGE 2</row>\n  <row label=\"r3\" groups=\"g1\" ss:rowClassNames=\"r3\">MESSAGE 3 MESSAGE 3 MESSAGE 3 MESSAGE 3 MESSAGE 3MESSAGE 3 MESSAGE 3 MESSAGE 3 MESSAGE 3</row>\n  <row label=\"r4\" groups=\"g1\" ss:rowClassNames=\"r4\">MESSAGE 4 MESSAGE 4 MESSAGE 4 MESSAGE 4 MESSAGE 4MESSAGE 4 MESSAGE 4 MESSAGE 4 MESSAGE 4</row>\n  <row label=\"r5\" groups=\"g2\" ss:rowClassNames=\"r5\">MESSAGE 5 MESSAGE 5 MESSAGE 5 MESSAGE 5 MESSAGE 5MESSAGE 5 MESSAGE 5 MESSAGE 5 MESSAGE 5</row>\n  <row label=\"r6\" groups=\"g2\" ss:rowClassNames=\"r6\">MESSAGE 6 MESSAGE 6 MESSAGE 6 MESSAGE 6 MESSAGE 6MESSAGE 6 MESSAGE 6 MESSAGE 6 MESSAGE 6</row>\n  <row label=\"r7\" groups=\"g2\" ss:rowClassNames=\"r7\">MESSAGE 7 MESSAGE 7 MESSAGE 7 MESSAGE 7 MESSAGE 7MESSAGE 7 MESSAGE 7 MESSAGE 7 MESSAGE 7</row>\n  <row label=\"r8\" groups=\"g2\" ss:rowClassNames=\"r8\">MESSAGE 8 MESSAGE 8 MESSAGE 8 MESSAGE 8 MESSAGE 8MESSAGE 8 MESSAGE 8 MESSAGE 8 MESSAGE 8</row>\n  <row label=\"r9\" groups=\"g3\" ss:rowClassNames=\"r9\">MESSAGE 9 MESSAGE 9 MESSAGE 9 MESSAGE 9 MESSAGE 9MESSAGE 9 MESSAGE 9 MESSAGE 9 MESSAGE 9</row>\n  <row label=\"r10\" groups=\"g3\" ss:rowClassNames=\"r10\">MESSAGE 10 MESSAGE 10 MESSAGE 10 MESSAGE 10 MESSAGE 10 MESSAGE 10 MESSAGE 10 MESSAGE 10 MESSAGE 10</row>\n  <row label=\"r11\" groups=\"g3\" ss:rowClassNames=\"r11\">MESSAGE 11 MESSAGE 11 MESSAGE 11 MESSAGE 11 MESSAGE 11 MESSAGE 11 MESSAGE 11 MESSAGE 11 MESSAGE 11</row>\n  <row label=\"r12\" groups=\"g3\" ss:rowClassNames=\"r12\">MESSAGE 12 MESSAGE 12 MESSAGE 12 MESSAGE 12 MESSAGE 12 MESSAGE 12 MESSAGE 12 MESSAGE 12 MESSAGE 12</row>\n  <row label=\"r13\" groups=\"g4\" ss:rowClassNames=\"r13\">MESSAGE 13 MESSAGE 13 MESSAGE 13 MESSAGE 13 MESSAGE 13 MESSAGE 13 MESSAGE 13 MESSAGE 13 MESSAGE 13</row>\n  <row label=\"r14\" groups=\"g4\" ss:rowClassNames=\"r14\">MESSAGE 14 MESSAGE 14 MESSAGE 14 MESSAGE 14 MESSAGE 14 MESSAGE 14 MESSAGE 14 MESSAGE 14 MESSAGE 14</row>\n  <row label=\"r15\" groups=\"g4\" ss:rowClassNames=\"r15\">MESSAGE 15 MESSAGE 15 MESSAGE 15 MESSAGE 15 MESSAGE 15 MESSAGE 15 MESSAGE 15 MESSAGE 15 MESSAGE 15</row>\n  <row label=\"r16\" groups=\"g4\" ss:rowClassNames=\"r16\">MESSAGE 16 MESSAGE 16 MESSAGE 16 MESSAGE 16 MESSAGE 16 MESSAGE 16 MESSAGE 16 MESSAGE 16 MESSAGE 16</row>\n  <col label=\"c1\" ss:colClassNames=\"c1\">S</col>\n  <col label=\"c2\" ss:colClassNames=\"c2\">L1</col>\n  <col label=\"c3\" ss:colClassNames=\"c3\">L2</col>\n  <col label=\"c4\" ss:colClassNames=\"c4\">L3</col>\n  <col label=\"c5\" ss:colClassNames=\"c5\">S</col>\n  <style label=\"Q500_FINAL_FULL\" cond=\"1\" name=\"question.after\"><![CDATA[\n<style>\n#-grid-table-1 { display:none; }\n\n/* =========================\n   LAYOUT\n========================= */\n.q500-wrap{\n    display:flex;\n    gap:20px;\n    margin-top:20px;\n}\n.q500-themes{ width:100%; }\n.q500-slots{ width:100%;\n\n    border: 1px solid #ccc;\n    border-radius: 12px;\n    overflow: hidden;\n }\n\n/* =========================\n   THEMES\n========================= */\n.theme-box{\n    border:1px solid #ccc;\n    border-radius:6px;\n    margin-bottom:10px;\n    overflow:hidden;\n}\n.theme-header{\n    background:#f5f7fa;\n    padding:10px;\n    font-weight:bold;\n    cursor:pointer;\n    display:flex;\n    align-items:center;\n    gap:8px;\n}\n.theme-arrow{\n    transition:transform .25s ease;\n}\n.theme-box.open .theme-arrow{\n    transform:rotate(90deg);\n}\n.theme-title{ flex:1; }\n.theme-count{\n    min-width:22px;\n    height:22px;\n    line-height:22px;\n    text-align:center;\n    border-radius:50%;\n    font-size:12px;\n    font-weight:bold;\n}\n.count-zero{\n    background:#ffd6d6;\n    color:#b00000;\n}\n.count-ok{\n    background:#e0f2e0;\n    color:#146b14;\n}\n.theme-list{\n    display:none;\n    padding:10px;\n}\n\nul.slot-list.connected.ui-sortable {\n    background: black;\n    padding: 8px;\n}\n.slot-list li.msg {\n    background: #2b2b2b;\n    border-color: #3a3a3a;\n    color: #f9fafb;\n}\n/* =========================\n   MESSAGES\n========================= */\n.msg{\n\tfont-size: small;\n    background:#fff;\n    border:1px solid #ccc;\n    border-radius:6px;\n    padding:6px 8px;\n    margin-bottom:6px;\n    cursor:move;\n    transition:transform .15s ease, box-shadow .15s ease;\n}\n.msg:active{\n    transform:scale(1.02);\n    box-shadow:0 4px 10px rgba(0,0,0,.15);\n}\n\n/* =========================\n   RIGHT PANEL\n========================= */\n.sec-head{\n    background:#000;\n    color:#fff;\n    padding:10px;\n    font-weight:bold;\n}\n.sec-desc{\n    background:#000;\n    color:#ddd;\n    padding:6px 10px;\n    font-style:italic;\n}\n.slot-row{\n    display:flex;\n    border-top:1px solid #000;\n}\n.slot-label {\n    width: 50px;\n    align-items: center;\n    display: flex;\n    padding: 10px;\n    font-weight: bold;\n    justify-content: center;\n    align-content: flex-start;\n}\n.slot-list{\n    flex:1;\n    min-height:52px;\n    padding:10px;\n}\n.placeholder-text{\n    color:#ff6a00;\n    font-size:13px;\n}\n\n/* =========================\n   SORTABLE POLISH\n========================= */\n.ui-sortable-placeholder{\n    height:38px;\n    border:2px dashed #ff6a00;\n    background:#fff8f1;\n}\n.slot-list.ui-sortable-over{\n    background:#f9f9f9;\n}\n\n/* =========================\n   MOBILE\n========================= */\n\\@media (max-width:768px){\n    .q500-wrap{ flex-direction:column; }\n    .q500-themes,.q500-slots{ width:100%; }\n    .theme-header{ padding:12px; }\n}\n\n/* =========================\n   SHELL PANELS\n========================= */\n.q500-shell{\n    display:flex;\n    gap:24px;\n    margin-top:20px;\n}\n\n.q500-left-panel,\n.q500-right-panel{\n    background:#fff;\n    border-radius:12px;\n    box-shadow:0 2px 10px rgba(0,0,0,.06);\n    padding:16px;\n}\n\n.q500-left-panel{ width:35%; }\n.q500-right-panel{ width:65%; }\n\n/* LEFT HEADER */\n.left-title{\n    font-weight:700;\n    text-align:center;\n    margin-bottom:12px;\n    letter-spacing:.5px;\n}\n\n/* RIGHT SECTION HEADERS */\n.block-head{\n    background:#f3f4f6;\n    padding: 10px 12px;\n    border-radius:10px 10px 0 0;\n    text-align:center;\n\n}\n.block-desc{\n    font-style:italic;\n    font-size:13px;\n    color:#666;\n    text-align:center;\n    padding:6px 12px 12px;\n}\n\n/* MOBILE */\n\\@media (max-width:768px){\n    .q500-shell{\n        flex-direction:column;\n    }\n    .q500-left-panel,\n    .q500-right-panel{\n        width:100%;\n    }\n}\n.question ul li, .comment ul li {\n    list-style: none;\n}\n\n</style>\n<link rel=\"stylesheet\" href=\"https://code.jquery.com/ui/1.13.3/themes/base/jquery-ui.css\">\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js\"></script>\n<script>\n\n$ (document).ready(function(){\n\nvar $grid = $ (\"#-grid-table-1\");\nvar STORE = \"Q500_STATE\";\n\n/* =========================\n   PARSE GRID (DESKTOP + MOBILE SAFE)\n========================= */\nvar data = {};\nvar currentTheme = \"\";\n\n$grid.find(\"th.row-legend-group, th.row-legend-basic\").each(function(){\n    var $th = $ (this);\n\n    if($th.hasClass(\"row-legend-group\")){\n        currentTheme = $.trim($th.html());\n        if(!data[currentTheme]) data[currentTheme]=[];\n        return;\n    }\n\n    if($th.hasClass(\"row-legend-basic\")){\n        var cls = $th.attr(\"class\").match(/r\\d+/);\n        if(!cls || !currentTheme) return;\n        data[currentTheme].push({\n            row:cls[0],\n            text:$.trim($th.html())\n        });\n    }\n});\n\n/* =========================\n   BUILD UI\n========================= */\nfunction section(t,d,rows){\n    var h='';\n    \n    for(var i=0;i<rows.length;i++) h+=rows[i];\n    return h;\n}\nfunction slot(l,c){\n    return '<div class=\"slot-row\">'+\n        '<div class=\"slot-label\">'+l+'</div>'+\n        '<ul class=\"slot-list connected\" data-col=\"'+c+'\" data-max=\"1\">'+\n            '<span class=\"placeholder-text\"></span>'+\n        '</ul></div>';\n}\n\nvar html =\n'<div class=\"q500-shell\">' +\n\n  '<div class=\"q500-left-panel\">' +\n    '<div class=\"left-title\">CATEGORY</div>' +\n    '<div class=\"q500-themes\" id=\"themes\"></div>' +\n  '</div>' +\n\n  '<div class=\"q500-right-panel\">' +\n    '<div class=\"q500-slots\">' +\n\n      '<div class=\"block-head\"><b>START</b><br/><i>The message that catches your attention</i></div>' +\n      \n      section(\"\", \"\", [ slot(\"H\",\"c1\") ]) +\n\n      '<div class=\"block-head\"><b>Important Points</b>: <br/><i>2â€“3 things you think matter most</i></div>' +\n      \n      section(\"\", \"\", [\n        slot(\"L1\",\"c2\"),\n        slot(\"L2\",\"c3\"),\n        slot(\"L3\",\"c4\")\n      ]) +\n\n      '<div class=\"block-head\"><b>Final Thought</b><br/><i>The message you want to end with</i></div>' +\n      \n      section(\"\", \"\", [ slot(\"S\",\"c5\") ]) +\n\n    '</div>' +\n  '</div>' +\n\n'</div>';\n\n$grid.closest(\".answers\").append(html);\n\n/* =========================\n   THEMES UI\n========================= */\n$.each(data,function(t,rows){\n    var box='<div class=\"theme-box\">'+\n      '<div class=\"theme-header\">'+\n        '<span class=\"theme-arrow\">â–¶</span>'+\n        '<span class=\"theme-title\">'+t+'</span>'+\n        '<span class=\"theme-count count-zero\" data-theme=\"'+t+'\">0</span>'+\n      '</div>'+\n      '<ul class=\"theme-list connected\" data-theme=\"'+t+'\">';\n    $.each(rows,function(_,r){\n        box+='<li class=\"msg\" data-row=\"'+r.row+'\" data-theme=\"'+t+'\">'+r.text+'</li>';\n    });\n    box+='</ul></div>';\n    $ (\"#themes\").append(box);\n});\n\n/* Accordion */\n$ (document).on(\"click\",\".theme-header\",function(){\n    $ (this).parent().toggleClass(\"open\")\n           .find(\".theme-list\").slideToggle();\n});\n\n/* =========================\n   SORTABLE\n========================= */\n$ (\".connected\").sortable({\n    connectWith: \".connected\",\n    placeholder: \"ui-sortable-placeholder\",\n    tolerance: \"pointer\",\n\n    /* ðŸ”’ PREVENT MISTOUCH DRAG */\n    delay: 250,        // long-press before drag starts\n    distance: 10,      // finger must move 10px before drag\n\n    start: function (e, ui) {\n        ui.item.addClass(\"dragging\");\n    },\n    stop: function () {\n        $ (\".msg\").removeClass(\"dragging\");\n        syncRadios();\n        saveState();\n        updateCounts();\n        cleanPlaceholders();\n    },\n    receive: function (e, ui) {\n        var $to = $ (this);\n\n        if ($to.data(\"max\") && $to.children(\".msg\").length > 1) {\n            $ (ui.sender).sortable(\"cancel\");\n            return;\n        }\n\n        if ($to.hasClass(\"theme-list\")) {\n            if (ui.item.data(\"theme\") !== $to.data(\"theme\")) {\n                $ (ui.sender).sortable(\"cancel\");\n            }\n        }\n    }\n});\n/* =========================\n   HELPERS\n========================= */\nfunction cleanPlaceholders(){\n    $ (\".slot-list\").each(function(){\n        $ (this).find(\".placeholder-text\")\n               .toggle(!$ (this).children(\".msg\").length);\n    });\n}\n\nfunction syncRadios(){\n    $grid.find(\"input[type=radio]\").prop(\"checked\",false);\n    $ (\".slot-list\").each(function(){\n        var col=$ (this).data(\"col\");\n        $ (this).find(\".msg\").each(function(){\n            $grid.find(\".\"+$ (this).data(\"row\")+\".\"+col+\" input\")\n                 .prop(\"checked\",true);\n        });\n    });\n}\n\nfunction updateCounts(){\n    var cnt={};\n    $ (\".msg\").each(function(){ cnt[$ (this).data(\"theme\")]=0; });\n    $ (\".slot-list .msg\").each(function(){\n        cnt[$ (this).data(\"theme\")]++;\n    });\n    $ (\".theme-count\").each(function(){\n        var t=$ (this).data(\"theme\");\n        var c=cnt[t]||0;\n        $ (this).text(c)\n               .removeClass(\"count-zero count-ok\")\n               .addClass(c? \"count-ok\":\"count-zero\");\n    });\n}\n\n/* =========================\n   STATE\n========================= */\nfunction saveState(){\n    var s={};\n    $ (\".slot-list\").each(function(){\n        var col=$ (this).data(\"col\");\n        $ (this).find(\".msg\").each(function(){\n            s[$ (this).data(\"row\")]=col;\n        });\n    });\n    sessionStorage.setItem(STORE,JSON.stringify(s));\n}\nfunction restoreState(){\n    var s=sessionStorage.getItem(STORE);\n    if(!s) return;\n    s=JSON.parse(s);\n    $.each(s,function(r,c){\n        $ ('.msg[data-row=\"'+r+'\"]').appendTo(\n            '.slot-list[data-col=\"'+c+'\"]'\n        );\n    });\n    syncRadios();\n    updateCounts();\n    cleanPlaceholders();\n}\nrestoreState();\n\n});\n</script>\n]]></style>\n</radio>\n\n<suspend/>\n",
    "tags": [
      "Setup"
    ]
  }
]